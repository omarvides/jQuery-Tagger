(function(a,b,c){a.fn.tagger=function(b){function d(a,b){if(b.acceptedTagRegex!=c)return b.acceptedTagRegex.test(a);else if(b.rejectedTagRegex!=c)return!b.rejectedTagRegex.test(a);else return true}function e(b,e,f,g){if(b!=c&&b!=""){if(d(b,e)){var h=a("<a class='"+e.closeClass+"'>"+e.closeChar+"</a>").click(function(){a(this).parent().remove();g.val(g.val().replace(b+",",""))});var i=c,j="";if(e.useColorFunction)i=e.colorFunction(b);var k=a("<span class='"+e.tagClass+"'>"+b+"</span>").append(h);if(i!=c)k.css({color:i.font,"background-color":i.background});k.insertBefore(f);f.next().val(b+e.separator+f.next().val());e.tagPlacedCallback(k,b)}else{e.rejectedTagCallback(f,b)}}}var f=a.extend({},a.fn.tagger.defaults,b);return this.each(function(){var b=a(this);var c=b.attr("name");b.attr("name","tagger_old_"+c);var d=a("<input type='hidden' name='"+c+"' />");var g=a("<div class='"+f.taggerWrapperClass+"'></div>");b.replaceWith(g);g.append(b).append(d);g.click(function(){b.focus()});for(var h=0;h<f.startWith.length;h++)e(f.startWith[h],f,b,d);var i=false;b.keypress(function(b){var c=a(this);if(b.which==f.separator.charCodeAt(0)){var g=a.trim(a(this).val());g=g.substr(0,g.length);e(g,f,c,d);c.val("");return false}return true})})};a.fn.tagger.defaults={separator:",",useColorFunction:true,colorFunction:function(a){return{font:"#333",background:"#CCC"}},startWith:new Array,closeChar:"x",tagClass:"tag",taggerWrapperClass:"tagger-input-container",closeClass:"close",tagPlacedCallback:function(a,b){},rejectedTagCallback:function(a,b){},acceptedTagRegex:c,rejectedTagRegex:c}})(jQuery,window)